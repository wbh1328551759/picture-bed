{"version":3,"sources":["components/Uploader.js","components/Tips.js","pages/Home.js"],"names":["Dragger","Upload","Result","styled","div","H1","h1","Image","img","Component","observer","ref1","useRef","ref2","useStores","ImageStore","UserStore","store","useLocalStore","width","setWidth","height","setHeight","serverFile","attributes","url","widthStr","heightStr","props","showUploadList","beforeUpload","file","console","log","setFile","setFilename","name","currentUser","test","type","size","message","error","upload","then","catch","warning","tip","spinning","isUploading","className","InboxOutlined","target","href","filename","src","alt","ref","onChange","current","value","placeholder","fullStr","Tips","children","Home","Uploader"],"mappings":"ojBAOOA,EAAWC,IAAXD,QAEDE,EAASC,IAAOC,IAAV,KAKNC,EAAKF,IAAOG,GAAV,KAIFC,EAAQJ,IAAOK,IAAV,KA+GIC,EA3GGC,aAAS,WACzB,IAAMC,EAAOC,mBACPC,EAAOD,mBAFkB,EAGCE,cAAzBC,EAHwB,EAGxBA,WAAYC,EAHY,EAGZA,UACbC,EAAQC,aAAc,iBAAO,CACjCC,MAAO,KACPC,SAFiC,SAExBD,GACPF,EAAME,MAAQA,GAEhB,eACE,OAAOF,EAAME,MAAN,aAAoBF,EAAME,OAAU,IAE7CE,OAAQ,KACRC,UATiC,SASvBD,GACRJ,EAAMI,OAASA,GAEjB,gBACE,OAAOJ,EAAMI,OAAN,aAAqBJ,EAAMI,QAAW,IAE/C,cACE,OAAON,EAAWQ,WAAWC,WAAWC,IAAID,WAAWC,IAAM,gBAAkBR,EAAMS,SAAWT,EAAMU,eAWpGC,EAAQ,CACZC,gBAAgB,EAChBC,aAAc,SAAAC,GAIZ,OAHAC,QAAQC,IAAIF,GACZhB,EAAWmB,QAAQH,GACnBhB,EAAWoB,YAAYJ,EAAKK,MACvBpB,EAAUqB,YAIV,wCAAwCC,KAAKP,EAAKQ,MAInDR,EAAKS,KAAO,SACdC,IAAQC,MAAM,uDACP,IAGT3B,EAAW4B,SACRC,MAAK,SAAArB,GACJS,QAAQC,IAAI,4BACZD,QAAQC,IAAIV,MACXsB,OAAM,WACTb,QAAQC,IAAI,gCAEP,IAfLQ,IAAQC,MAAM,iFACP,IALPD,IAAQK,QAAQ,mDAAY,IACrB,KAsBb,OACE,6BACE,kBAAC,IAAD,CAAMC,IAAI,qBAAMC,SAAUjC,EAAWkC,aACnC,kBAACjD,EAAY4B,EACX,uBAAGsB,UAAU,wBACX,kBAACC,EAAA,EAAD,OAEF,uBAAGD,UAAU,mBAAb,0DACA,uBAAGA,UAAU,mBAAb,2GAMFnC,EAAWQ,WAAa,kBAACrB,EAAD,KACtB,kBAACG,EAAD,iCACA,4BACE,8DACA,4BACE,uBAAG+C,OAAO,SAASC,KAAMtC,EAAWQ,WAAWC,WAAWC,IAAID,WAAWC,KACtEV,EAAWQ,WAAWC,WAAWC,IAAID,WAAWC,MAGrD,wDACA,4BAAKV,EAAWuC,UAChB,8DACA,4BACE,kBAAC/C,EAAD,CAAOgD,IAAKxC,EAAWQ,WAAWC,WAAWC,IAAID,WAAWC,IAAK+B,IAAI,MAEvE,wDACA,4BACE,2BAAOC,IAAK9C,EAAM+C,SApEN,WACtBzC,EAAMG,SAAST,EAAKgD,QAAQC,QAmE2BrB,KAAK,OAAOsB,YAAY,qDACrE,2BAAOJ,IAAK5C,EAAM6C,SAlEL,WACvBzC,EAAMK,UAAUT,EAAK8C,QAAQC,QAiE2BrB,KAAK,OAAOsB,YAAY,sDAExE,4BACE,uBAAGT,OAAO,SAASC,KAAMpC,EAAM6C,SAC5B7C,EAAM6C,YAIH,S,0KCtHpB,IAAMC,EAAO5D,IAAOC,IAAV,KAmBKK,EAXGC,aAAS,YAAiB,IAAfsD,EAAc,EAAdA,SACnBhD,EAAcF,cAAdE,UACR,OACE,oCAEIA,EAAUqB,YAAc,KAAM,kBAAC0B,EAAD,KAAOC,OCbvCC,EAAOvD,aAAS,WAGpB,OACE,oCACE,kBAAC,EAAD,yDAGA,kBAACwD,EAAD,UAKSD","file":"static/js/10.01cd4559.chunk.js","sourcesContent":["import React, {useRef} from 'react'\r\nimport {useStores} from '../stores'\r\nimport {observer, useLocalStore} from 'mobx-react'\r\nimport {Upload, message, Spin} from 'antd';\r\nimport {InboxOutlined} from '@ant-design/icons';\r\nimport styled from 'styled-components';\r\n\r\nconst {Dragger} = Upload;\r\n\r\nconst Result = styled.div`\r\n  margin-top: 30px;\r\n  border: 1px dashed #ccc;\r\n  padding: 20px;\r\n`\r\nconst H1 = styled.h1`\r\n  margin: 20px 0;\r\n  text-align: center;\r\n`\r\nconst Image = styled.img`\r\n  max-width: 300px;\r\n`\r\n\r\nconst Component = observer(() => {\r\n  const ref1 = useRef()\r\n  const ref2 = useRef()\r\n  const {ImageStore, UserStore} = useStores()\r\n  const store = useLocalStore(() => ({\r\n    width: null,\r\n    setWidth(width) {\r\n      store.width = width;\r\n    },\r\n    get widthStr() {\r\n      return store.width ? `/w/${store.width}` : '';\r\n    },\r\n    height: null,\r\n    setHeight(height) {\r\n      store.height = height;\r\n    },\r\n    get heightStr() {\r\n      return store.height ? `/h/${store.height}` : '';\r\n    },\r\n    get fullStr() {\r\n      return ImageStore.serverFile.attributes.url.attributes.url + '?imageView2/0' + store.widthStr + store.heightStr\r\n    }\r\n  }))\r\n\r\n  const bindWidthChange = () => {\r\n    store.setWidth(ref1.current.value)\r\n  }\r\n  const bindHeightChange = () => {\r\n    store.setHeight(ref2.current.value)\r\n  }\r\n\r\n  const props = {\r\n    showUploadList: false,\r\n    beforeUpload: file => {\r\n      console.log(file)\r\n      ImageStore.setFile(file)\r\n      ImageStore.setFilename(file.name)\r\n      if (!UserStore.currentUser) {\r\n        message.warning('请先登录再上传！', 3)\r\n        return false\r\n      }\r\n      if (!/(svg$)|(png$)|(jpg$)|(jpeg$)|(gif$)/ig.test(file.type)) {\r\n        message.error('只能上传 png/svg/jpg/jpeg/gif 格式的图片')\r\n        return false\r\n      }\r\n      if (file.size > 1024 * 1024) {\r\n        message.error('图片大小不能超过1M')\r\n        return false\r\n      }\r\n\r\n      ImageStore.upload()\r\n        .then(serverFile => {\r\n          console.log('上传成功')\r\n          console.log(serverFile)\r\n        }).catch(() => {\r\n        console.log('上传失败')\r\n      })\r\n      return false;\r\n    },\r\n  }\r\n\r\n  return (\r\n    <div>\r\n      <Spin tip=\"上传中\" spinning={ImageStore.isUploading}>\r\n        <Dragger {...props}>\r\n          <p className=\"ant-upload-drag-icon\">\r\n            <InboxOutlined/>\r\n          </p>\r\n          <p className=\"ant-upload-text\">点击或拖拽上传图片</p>\r\n          <p className=\"ant-upload-hint\">\r\n            仅支持 .png/.gif/.jpg/.svg 格式的图片，图片最大1M\r\n          </p>\r\n        </Dragger>\r\n      </Spin>\r\n      {\r\n        ImageStore.serverFile ? <Result>\r\n          <H1>上传结果</H1>\r\n          <dl>\r\n            <dt>线上地址：</dt>\r\n            <dd>\r\n              <a target=\"_blank\" href={ImageStore.serverFile.attributes.url.attributes.url}>\r\n                {ImageStore.serverFile.attributes.url.attributes.url}\r\n              </a>\r\n            </dd>\r\n            <dt>文件名：</dt>\r\n            <dd>{ImageStore.filename}</dd>\r\n            <dt>图片预览：</dt>\r\n            <dd>\r\n              <Image src={ImageStore.serverFile.attributes.url.attributes.url} alt=\"\"/>\r\n            </dd>\r\n            <dt>更多尺寸</dt>\r\n            <dd>\r\n              <input ref={ref1} onChange={bindWidthChange} type=\"text\" placeholder=\"最大宽度（可选）\"/>\r\n              <input ref={ref2} onChange={bindHeightChange} type=\"text\" placeholder=\"最大高度（可选）\"/>\r\n            </dd>\r\n            <dd>\r\n              <a target=\"_blank\" href={store.fullStr}>\r\n                {store.fullStr}\r\n              </a>\r\n            </dd>\r\n          </dl>\r\n        </Result> : null\r\n      }\r\n    </div>\r\n  )\r\n})\r\n\r\nexport default Component","import React from 'react'\r\nimport { useStores } from '../stores'\r\nimport { observer } from 'mobx-react'\r\nimport styled from 'styled-components'\r\n\r\nconst Tips = styled.div`\r\n  background: orange;\r\n  padding: 10px;\r\n  margin: 30px 0;\r\n  color: #fff;\r\n  border-radius: 4px;\r\n`\r\n\r\nconst Component = observer(({children}) => {\r\n  const { UserStore } = useStores()\r\n  return (\r\n    <>\r\n      {\r\n        UserStore.currentUser ? null: <Tips>{children}</Tips>\r\n      }\r\n    </>\r\n  )\r\n})\r\n\r\nexport default Component","import React from 'react'\r\nimport { observer } from 'mobx-react'\r\nimport Uploader from '../components/Uploader'\r\nimport Tips from '../components/Tips'\r\n\r\nconst Home = observer(() => {\r\n\r\n\r\n  return(\r\n    <>\r\n      <Tips>\r\n        请先登录再上传！\r\n      </Tips>\r\n      <Uploader/>\r\n    </>\r\n  )\r\n})\r\n\r\nexport default Home"],"sourceRoot":""}